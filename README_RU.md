# Maya Orient Tool

![Dialog](images/img1.png)

Позволяет восстановить ориентацию объекта на основании выбранных опорных элементов.
Этот инструмент полезен в случаях когда исходный объект был трансформирован в сцене 
и трансформации были заморожены. Например, вся геометрия в сцене слита в единый объект.
После разъединения большого объекта в отдельные объекты Orient Tool поможет вам восстановить трансформации
исходных объектов и переместить их в центр мировых координат.

### Установка

Скопируйте папку `pw_restore_object_orient` в директорию со скриптами для Maya. например `~/maya/scripts`

Для запуска в Maya добавьте кнопку с таким кодом

```python
import pw_restore_object_orient
pw_restore_object_orient.show()
```

### Варианты опорных элементов

- 1 point
- 2 points
- 3 points
- 1 edge
- 2 edges
- multiple edges (more than 2)
- 1 face
- 1 point + 1 edge
- 1 point + 2 edges
- 2 faces
- multiple faces (more than 2)

При выделении старайтесь выбрать опорные элементы находящиеся на оси симметрии 
или расположенные симметрично относительно центральной оси. При выделении множества компонентов имеет смысл выбирать копланарные компоненты (лежат в одной плоскости). 

### Элементы управления

`Set Object` - выбрать объект с которым будете работать. Это может быть только нода типа `Transform`. Если выбрана группа, то все манипуляции будут влиять на все объекты в группе.

`Align Selected` - выровнять объект используя текущее выделение

`Align Selected To Axis` - выровнять объект используя текущее выделение, при этом выделенный опорный элемент будет ориентирован по определённой оси. 
Зажмите **Shift**, чтобы инвертировать направление этой оси.

`Rotate` - группа кнопок для быстрого вращения и выравнивания ориентации

`X/Y/Z` - Ориентировать объект вдоль выбранной оси относительно выбранного элемента. Рассчитанный вектор будет направлен ровно по указанной оси.

`xz/xy/yz/yx/zy/zx` - Повернуть ось выбранного элемента на выбранную плоскость по кратчайшему пути. 
Перед нажатием зажмите **Shift**, чтобы повернуть вокруг первой оси, и **Ctrl**, чтобы повернуть вокруг второй оси. 
Например, если выделить ребро и нажать кнопку `xz` то объект повернётся выбранным ребром к плоскости `xz` по кратчайшему пути.
Если перед нажатием зажать **Shift**, то вращение произойдет вдоль оси `x`, если зажать **Ctrl**, то ось вращения будет глобальная ось `z`. 
Это позволить сохранить изначальную ориентацию вдоль указанной оси.

`+180/+90/-90/-180` - вращение по указанной оси на указанный угол

`Bottom` - Переместить объект в центр координат по `X` и `Z` и выровнять самую нижнюю точку в 0 по оси `Y`.

`Center` - Переместить центр объекта в центр мировых координат.

`Selected` - Найти центр выделенных элементов и переместить его в центр мировых координат.

`Freeze` - вызвать команду `Modify/Freeze Transformations` для текущего объекта и всех дочерних объектов.

`Reset` - сбросить изменения текущего объекта. 

`Restore Transform` - Восстановить исходные трансформации. Опция доступна пока не сброшен выбор текущего объекта.

### Расчёт исходного вектора

Из любых поддерживаемых комбинаций выделенных компонентов всегда рассчитывается исходный вектор или базис для поворота.
Например, если выделен 1 полигон то его исходный вектор это нормаль данного полигона. Если выделено несколько полигонов,
то исходный вектор это усреднённая нормаль этих полигонов.
При выделении ребра исходный вектор направлен вдоль этого ребра. 
При выделении двух точке вектор будет смотреть их одной точки в другую.

Это следует учитывать при выборе опорных компонентов.

### Отличие команд поворота

Кнопки `X/Y/Z` всегда ориентируют исходный вектор вдоль указанной оси. Их стоит использовать как первичный поворот.

Кнопки `xz/xy/yz/yx/zy/zx` поворачивают опорный вектор на проекцию указанной плоскости. Лучше использовать для корректирующего поворота. 
При использовании модификаторов **Shift** и **Ctrl** можно сохранять ориентацию относительно глобальных осей при проецировании компонентов на плоскость.
Также учитывайте что для полигонов опорный вектор будет нормалью этого полигона, а не плоскость полигона. 

### TODO

- Проекция на плоскость пока не рассчитана на работу с полигонами
- Интерфейс для выравнивания множества одинаковых объектов по одному правилу